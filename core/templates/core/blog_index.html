{% extends 'base.html' %}

{% block content %}
<section>
    <h1 class="section-title">блог</h1>
    
    {% if user.is_authenticated %}
    <div style="margin-bottom: 2rem; display: flex; gap: 1rem;">
        <a href="{% url 'blog_editor_new' %}" style="padding: 0.5rem 1rem; background: #3b82f6; color: white; border-radius: 6px; text-decoration: none; font-size: 0.9rem;">+ New Post</a>
        <a href="{% url 'blog_drafts' %}" style="padding: 0.5rem 1rem; background: #6b7280; color: white; border-radius: 6px; text-decoration: none; font-size: 0.9rem;">View Drafts</a>
    </div>
    {% endif %}
    
    <div class="post-grid">
        {% for post in posts %}
        <a href="{% url 'post_detail' post.slug %}" class="post-card">
            {% if post.featured_image %}
            <div class="post-card-image">
                <img src="{{ post.featured_image }}" alt="{{ post.title }}">
            </div>
            {% endif %}
            <div class="post-card-content">
                <h2 class="post-card-title">{{ post.title }}</h2>
                <p class="post-card-excerpt">{{ post.get_excerpt }}</p>
                <span class="post-card-meta">{{ post.created_at|date:"M d, Y" }}</span>
            </div>
        </a>
        {% empty %}
        <p>No posts yet.</p>
        {% endfor %}
    </div>
</section>

<style>
.post-grid {
    display: grid;
    gap: 2rem;
}

.post-card {
    display: flex;
    gap: 1.5rem;
    text-decoration: none;
    color: inherit;
    padding: 1rem 0;
    border-bottom: 1px solid var(--border-color, #eee);
    transition: transform 0.2s ease;
}

.post-card:hover {
    transform: translateX(4px);
}

.post-card-image {
    flex-shrink: 0;
    width: 180px;
    height: 120px;
    overflow: hidden;
    border-radius: 8px;
    background: #f0f0f0;
}

.post-card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.post-card-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.post-card-title {
    font-size: 1.25rem;
    font-weight: 700;
    margin: 0 0 0.5rem;
    font-family: var(--font-mono, monospace);
}

.post-card-excerpt {
    font-size: 0.95rem;
    color: var(--secondary-text, #666);
    margin: 0 0 0.75rem;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.post-card-meta {
    font-size: 0.8rem;
    color: var(--secondary-text, #888);
    font-family: var(--font-mono, monospace);
}

@media (max-width: 600px) {
    .post-card {
        flex-direction: column;
        gap: 1rem;
    }
    
    .post-card-image {
        width: 100%;
        height: 180px;
    }
}
</style>
{% endblock %}